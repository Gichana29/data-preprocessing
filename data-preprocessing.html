<!-- This Source Code Form is subject to the terms of the Mozilla Public
   - License, v. 2.0. If a copy of the MPL was not distributed with this file,
   - You can obtain one at http://mozilla.org/MPL/2.0/. -->
<!DOCTYPE html>
<html platform="linux" dir="ltr" lang="en-US"><head>
  <title id="reader-title">Data Preprocessing in R | Engineering Education (EngEd) Program | Section</title>
  <meta http-equiv="Content-Security-Policy" content="default-src chrome:; img-src data: *; media-src *; object-src 'none'">
  <meta content="text/html; charset=UTF-8" http-equiv="content-type">
  <meta name="viewport" content="width=device-width; user-scalable=0">
  <link rel="stylesheet" href="chrome://global/skin/aboutReader.css" type="text/css">
  <link rel="stylesheet" href="chrome://global/skin/aboutReaderPocket.css" type="text/css">
  <link rel="localization" href="toolkit/about/aboutReader.ftl">
  <link rel="localization" href="browser/branding/brandings.ftl">
<link rel="stylesheet" href="chrome://global/skin/narrate.css"><link rel="shortcut icon" href="https://www.section.io/favicon.ico?v=1"></head>

<body class="dark serif loaded" style="--font-size: 28px; --content-width: 35em;">
  <div class="top-anchor"></div>

  <div id="toolbar" class="toolbar-container scrolled">
    <div class="toolbar reader-toolbar">
      <div class="reader-controls" articledir="ltr">
        <button class="close-button toolbar-button" aria-labelledby="toolbar-close" data-telemetry-id="reader-close">
          <span class="hover-label" id="toolbar-close" data-l10n-id="about-reader-toolbar-close">Close Reader View</span>
        </button>
        <ul class="dropdown style-dropdown">
          <li>
            <button class="dropdown-toggle toolbar-button style-button" aria-labelledby="toolbar-type-controls" data-telemetry-id="reader-type-controls">
              <span class="hover-label" id="toolbar-type-controls" data-l10n-id="about-reader-toolbar-type-controls">Type controls</span>
            </button>
          </li>
          <li class="dropdown-popup">
            <div class="dropdown-arrow"></div>
            <div class="font-type-buttons radiorow"><input id="radio-itemsans-serif-button" type="radio" class="radio-button" name="font-type"><label for="radio-itemsans-serif-button" class="sans-serif-button" data-l10n-id="about-reader-font-type-sans-serif">Sans-serif</label><input id="radio-itemserif-button" type="radio" class="radio-button" name="font-type" checked="checked"><label for="radio-itemserif-button" class="serif-button" data-l10n-id="about-reader-font-type-serif" checked="true">Serif</label></div>
            <div class="font-size-buttons buttonrow">
              <button class="minus-button" data-l10n-id="about-reader-toolbar-minus" title="Decrease Font Size"></button>
              <span class="font-size-value">9</span>
              <button class="plus-button" data-l10n-id="about-reader-toolbar-plus" title="Increase Font Size"></button>
            </div>
            <div class="content-width-buttons buttonrow">
               <button class="content-width-minus-button" data-l10n-id="about-reader-toolbar-contentwidthminus" title="Decrease Content Width"></button>
               <span class="content-width-value">4</span>
               <button class="content-width-plus-button" data-l10n-id="about-reader-toolbar-contentwidthplus" title="Increase Content Width"></button>
            </div>
            <div class="line-height-buttons buttonrow">
                <button class="line-height-minus-button" data-l10n-id="about-reader-toolbar-lineheightminus" title="Decrease Line Height"></button>
                <span class="line-height-value">5</span>
                <button class="line-height-plus-button" data-l10n-id="about-reader-toolbar-lineheightplus" title="Increase Line Height"></button>
            </div>
            <div class="color-scheme-buttons radiorow"><input id="radio-itemlight-button" type="radio" class="radio-button" name="color-scheme"><label for="radio-itemlight-button" class="light-button" data-l10n-id="about-reader-color-scheme-light" title="Color Scheme Light">Light</label><input id="radio-itemdark-button" type="radio" class="radio-button" name="color-scheme" checked="checked"><label for="radio-itemdark-button" class="dark-button" data-l10n-id="about-reader-color-scheme-dark" checked="true" title="Color Scheme Dark">Dark</label><input id="radio-itemsepia-button" type="radio" class="radio-button" name="color-scheme"><label for="radio-itemsepia-button" class="sepia-button" data-l10n-id="about-reader-color-scheme-sepia" title="Color Scheme Sepia">Sepia</label><input id="radio-itemauto-button" type="radio" class="radio-button" name="color-scheme"><label for="radio-itemauto-button" class="auto-button" data-l10n-id="about-reader-color-scheme-auto" title="Color Scheme Auto">Auto</label></div>
          </li>
        </ul>
      <ul class="dropdown narrate-dropdown"><li><button class="dropdown-toggle toolbar-button narrate-toggle" data-telemetry-id="reader-listen" aria-label="Listen"><span class="hover-label">Listen</span></button></li><li class="dropdown-popup"><div class="narrate-row narrate-control"><button class="narrate-skip-previous" disabled="disabled" title="Back"></button><button class="narrate-start-stop" title="Start (N)"></button><button class="narrate-skip-next" disabled="disabled" title="Forward"></button></div><div class="narrate-row narrate-rate"><input class="narrate-rate-input" value="0" step="5" max="100" min="-100" type="range" title="Speed"></div><div class="narrate-row narrate-voices"><div class="voiceselect voice-select"><button class="select-toggle" aria-controls="voice-options">
      <span class="label">Voice:</span> <span class="current-voice">Default</span>
    </button>
    <div class="options" id="voice-options" role="listbox" style="max-height: 757px;"><button data-value="automatic" class="option selected" tabindex="-1" role="option" aria-selected="true">Default</button><button data-value="urn:moz-tts:speechd:English%20(Great%20Britain)?en" class="option" tabindex="-1" role="option">English (en)</button><button data-value="urn:moz-tts:speechd:English%20(Lancaster)?en" class="option" tabindex="-1" role="option">English (en)</button><button data-value="urn:moz-tts:speechd:English%20(Caribbean)?en" class="option" tabindex="-1" role="option">English (en)</button><button data-value="urn:moz-tts:speechd:English%20(Scotland)?en" class="option" tabindex="-1" role="option">English (en)</button><button data-value="urn:moz-tts:speechd:English%20(West%20Midlands)?en" class="option" tabindex="-1" role="option">English (en)</button><button data-value="urn:moz-tts:speechd:English%20(Received%20Pronunciation)?en" class="option" tabindex="-1" role="option">English (en)</button><button data-value="urn:moz-tts:speechd:English%20(America)?en" class="option" tabindex="-1" role="option">English (en)</button></div></div></div><div class="dropdown-arrow"></div></li></ul><button data-buttonid="pocket-button" data-telemetry-id="reader-save-to-pocket" class="toolbar-button pocket-button" aria-labelledby="label-pocket-button" style="background-image: url(&quot;chrome://global/skin/icons/pocket.svg&quot;);"><span class="hover-label" id="label-pocket-button" data-l10n-id="about-reader-toolbar-savetopocket">Save To Pocket</span></button></div>
    </div>
  </div>

  <div class="container" style="--line-height: 1.8em;" dir="ltr" lang="en-us">
    <div class="header reader-header reader-show-element">
      <a class="domain reader-domain" href="https://www.section.io/engineering-education/data-preprocessing-in-r/">section.io</a>
      <div class="domain-border"></div>
      <h1 class="reader-title">Data Preprocessing in R</h1>
      <div class="credits reader-credits"></div>
      <div class="meta-data">
        <div class="reader-estimated-time" data-l10n-id="about-reader-estimated-read-time" data-l10n-args="{&quot;range&quot;:&quot;9–12&quot;,&quot;rangePlural&quot;:&quot;other&quot;}" dir="ltr">9–12 minutes</div>
      </div>
    </div>

    <hr>

    <div class="content">
      <div class="moz-reader-content reader-show-element"><div id="readability-page-1" class="page"><div><p>Data
 preprocessing is the initial phase of Machine Learning where data is 
prepared for machine learning models. This part is crucial and needs to 
be performed properly and systematically. If not, we will end up 
building models that are not accurate for their purpose.</p>
<p>In this article, we will learn all the steps that are involved in the data preprocessing stage.</p>
<h3 id="prerequisites">Prerequisites</h3>
<p>To follow this article along - the reader should have the following:</p>
<ol>
<li><a href="https://www.rstudio.com/products/rstudio/download/">RStudio</a> installed on your computer.</li>
<li>Package packages (‘caTools’) installed. Follow <a href="https://www.rdocumentation.org/packages/caTools/versions/1.17.1">this</a> link for installation instructions.</li>
</ol>
<h3 id="steps-in-data-preprocessing">Steps in data preprocessing</h3>
<ul>
<li><a href="#steps-in-data-preprocessing">Steps in Data Preprocessing</a>
<ul>
<li><a href="#step-1-importing-the-dataset">Step 1: Importing the Dataset</a></li>
<li><a href="#step-2-handling-the-missing-data">Step 2: Handling the Missing Data</a></li>
</ul>
</li>
<li><a href="#step-3-encoding-categorical-data">Step 3: Encoding Categorical Data.</a>
<ul>
<li><a href="#output">Output</a></li>
</ul>
</li>
<li><a href="#step-4-splitting-the-dataset-into-the-training-and-test-sets">Step 4: Splitting the Dataset into the Training and Test sets</a>
<ul>
<li><a href="#training-set">Training set</a></li>
<li><a href="#test-set">Test set</a></li>
</ul>
</li>
<li><a href="#step-5-feature-scaling">Step 5: Feature Scaling</a>
<ul>
<li><a href="#training_set">training_set</a></li>
<li><a href="#test_set">test_set</a></li>
</ul>
</li>
</ul>
<h4 id="step-1-importing-the-dataset">Step 1: Importing the dataset</h4>
<p>Before we start preparing our data, first we need to dowload it from <a href="https://github.com/Daniel695/data">here</a> and load it in RStudio IDE.</p>
<p>Here is how to achieve this.</p>
<div><pre tabindex="0"><code data-lang="r"><span><span>Dataset <span>=</span> <span>read_csv</span>(<span>'data.csv'</span>)
</span></span></code></pre></div><p>This code imports our data stored in CSV format.</p>
<p>We can have a look at our data using the ‘view()’ function:</p>
<p>Upon executing we obtain our dataset as below.</p>
<p><strong>Output</strong></p>
<p><img src="data-preprocessing_files/Dataset.png" alt="replaced Dataset" class="moz-reader-block-img"></p>
<p>Our dataset has four columns and ten observations, it shows how 
customers from three different countries with different ages and 
salaries responded to the purchase of a certain product.</p>
<h4 id="step-2-handling-the-missing-data">Step 2: Handling the missing data</h4>
<p>From the dataset, the Age and Salary column report missing data. 
Before implementing our machine learning models, this problem needs to 
be solved, otherwise it will cause a serious problem to our machine 
learning models. Therefore, it’s our responsibility to ensure this 
missing data is eliminated from our dataset using the most appropriate 
technique.</p>
<p>Here are two techniques we can use to handle missing data:</p>
<ol>
<li><strong>Delete the observation reporting the missing data:</strong></li>
</ol>
<p>This technique is suitable when dealing with big datasets and with 
very few missing values i.e. deleting one row from a dataset with 
thousands of observations can not affect the quality of the data. When 
the dataset reports many missing values, it can be very dangerous to use
 this technique. Deleting many rows from a dataset can lead to the loss 
of crucial information contained in the data.</p>
<p>To ensure this does not happen, we make use of an appropriate technique that has no harm to the quality of the data.</p>
<ol start="2">
<li><strong>Replace the missing data with the average of the feature in which the data is missing:</strong></li>
</ol>
<p>This technique is the best way so far to deal with the missing 
values. Many statisticians make use of this technique over that of the 
first one.</p>
<p>Now that we know the techniques used to treat the missing data, let’s
 solve this problem from our data. In our case, we shall make use of the
 second technique.</p>
<p>Let’s start by replacing the missing data in the Age column with the mean of that column.</p>
<p>The code below carries out such a task.</p>
<div><pre tabindex="0"><code data-lang="r"><span><span>Dataset<span>$</span>Age <span>=</span> <span>ifelse</span>(<span>is.na</span>(Dataset<span>$</span>Age),
</span></span><span><span>                     <span>ave</span>(Dataset<span>$</span>Age, FUN <span>=</span> <span>function </span>(x)<span>mean</span>(x, na.rm <span>=</span> <span>TRUE</span>)),
</span></span><span><span>                     Dataset<span>$</span>Age)
</span></span></code></pre></div><p><strong>What does the code above really do?</strong></p>
<p><code>Dataset$Age</code>: simply take the Age column from our dataset.</p>
<p>In the Age column, we’ve just taken that from our data set, we need 
to replace the missing data, and at the same time keep the data that is 
not missing.</p>
<p>This objective is achieved by the use of the if-else statement.</p>
<p>Our <code>ifelse</code> statement is taking three parameters:</p>
<ul>
<li>The first parameter is if the condition is true.</li>
<li>The second parameter is the value we input if the condition is true.</li>
<li>The third parameter is the action we take if the condition is false.</li>
</ul>
<p>Our condition is <code>is.na(Dataset$Age)</code>. This will tell us 
if a value in the Dataset$Age is missing or not. It returns a logical 
output, YES if a value is missing and NO if a value is not missing. The 
second parameter, the ‘ave()’ function, finds the mean of the Age 
column.</p>
<p>Because this column reports NA values, we need to exclude the null 
data in the calculation of the mean, otherwise we shall obtain the mean 
as NA.</p>
<p>This is the reason we pass <code>na.rm = TRUE</code> in our mean 
function just as to declare those values that should be used and those 
should be excluded when calculating the mean of the vector Age.</p>
<p>The third condition is the value that will be returned if the value in the Age column of the dataset is not missing.</p>
<p>Executing the code we obtain:</p>
<p><img src="data-preprocessing_files/dataset1.png" alt="replaced Age_NA value" class="moz-reader-block-img"></p>
<p>The missing value that was in the Age column of our data set has successfully been replaced with the mean of the same column.</p>
<p>We do the same for the Salary column by executing the code below:</p>
<div><pre tabindex="0"><code data-lang="r"><span><span>Dataset<span>$</span>Salary <span>=</span> <span>ifelse</span>(<span>is.na</span>(Dataset<span>$</span>Salary),
</span></span><span><span>                 <span>ave</span>(Dataset<span>$</span>Salary, FUN <span>=</span> <span>function </span>(x)<span>mean</span>(x, na.rm <span>=</span> <span>TRUE</span>)),
</span></span><span><span>                 Dataset<span>$</span>Salary)
</span></span></code></pre></div><p><img src="data-preprocessing_files/dataset2.png" alt="replaced NA_value of the Salary column" class="moz-reader-block-img"></p>
<p>The missing value that was in the Salary column was successfully replaced with the mean of the same column.</p>
<h3 id="step-3-encoding-categorical-data">Step 3: Encoding categorical data</h3>
<p>Encoding refers to transforming text data into numeric data. Encoding
 Categorical data simply means we are transforming data that fall into 
categories into numeric data.</p>
<p>In our dataset, the Country column is Categorical data with 3 levels 
i.e. France, Spain, and Germany. The purchased column is Categorical 
data as well with 2 categories, i.e. YES and NO.</p>
<p>The machine models we built on our dataset are based on mathematical equations and it’s only take numbers in those equations.</p>
<p>Keeping texts of a categorical variable in the equation can cause 
some troubles to the machine learning models and this why we encode 
those variables. To transform a categorical variable into numeric, we 
use the <code>factor()</code> function.</p>
<p>Let start by encoding the Country column.</p>
<div><pre tabindex="0"><code data-lang="r"><span><span>Dataset<span>$</span>Country <span>=</span> <span>factor</span>(Dataset<span>$</span>Country, 
</span></span><span><span>                      levels <span>=</span> <span>c</span>(<span>'France'</span>,<span>'Spain'</span>,<span>'Germany'</span>), 
</span></span><span><span>                      labels <span>=</span> <span>c</span>(<span>1.0</span>, <span>2.0</span> , <span>3.0</span> ))
</span></span></code></pre></div><p>Executing the code above we obtain.</p>
<p><strong>Output</strong></p>
<p><img src="data-preprocessing_files/encode1.png" alt="Encoded Country_names" class="moz-reader-block-img"></p>
<p>Our country names were successfully replaced with numbers.</p>
<p>We do the same for the purchased column.</p>
<div><pre tabindex="0"><code data-lang="r"><span><span>Dataset<span>$</span>Purchased <span>=</span> <span>factor</span>(Dataset<span>$</span>Purchased,
</span></span><span><span>                           levels <span>=</span> <span>c</span>(<span>'No'</span>, <span>'Yes'</span>),
</span></span><span><span>                           labels <span>=</span> <span>c</span>(<span>0</span>, <span>1</span>))
</span></span><span><span>Dataset<span>$</span>Purchased<span>[is.na</span>(Dataset<span>$</span>Purchased)] <span>&lt;-</span> <span>0</span>
</span></span><span><span><span>as.factor</span>(Dataset<span>$</span>Purchased)
</span></span></code></pre></div><p>Using the  <code>view()</code> function we obtain.</p>
<p><img src="data-preprocessing_files/encode_Purchased.png" alt="Encoded Purchased column" class="moz-reader-block-img"></p>
<p>Our purchased column was successfully encoded into 0,s, and 1,s.</p>
<h3 id="step-4-splitting-the-dataset-into-the-training-and-test-set">Step 4: Splitting the dataset into the training and test set</h3>
<p>In machine learning, we split data into two parts:</p>
<ul>
<li>Training set: The part of the data that we implement our machine learning model on.</li>
<li>Test set: The part of the data that we evaluate the performance of our machine learning model on.</li>
</ul>
<p>The reason we split this data is to ensure that our machine learning 
model does not overlearn the correlation of data it’s trained on. If we 
let it learn too much on the data, it may perform poorly when tested on a
 new dataset with a different correlation.</p>
<p>Therefore, whenever we are building a machine learning model, the 
idea is to implement it on the training set and evaluate it on the test 
set. We expect the performance in the training set and test set to be 
different and if this is the case the model can adapt to new datasets.</p>
<p>Using our dataset, let’s split it into the training and test sets.</p>
<p>To begin with, we first load the required library.</p>
<div><pre tabindex="0"><code data-lang="r"><span><span><span>library</span>(caTools)<span># required library for data splition</span>
</span></span><span><span><span>set.seed</span>(<span>123</span>)
</span></span><span><span>split <span>=</span> <span>sample.split</span>(Dataset<span>$</span>Purchased, SplitRatio <span>=</span> <span>0.8</span>)<span># returns true if observation goes to the Training set and false if observation goes to the test set.</span>
</span></span><span><span>
</span></span><span><span><span>#Creating the training set and test set separately</span>
</span></span><span><span>training_set <span>=</span> <span>subset</span>(Dataset, split <span>==</span> <span>TRUE</span>)
</span></span><span><span>test_set <span>=</span> <span>subset</span>(Dataset, split <span>==</span> <span>FALSE</span>)
</span></span><span><span>training_set
</span></span><span><span>test_set
</span></span></code></pre></div><p>Executing our code yields:</p>
<p><strong>Training Set</strong>:</p>
<p><img src="data-preprocessing_files/training_set.png" alt="training_set" class="moz-reader-block-img"></p>
<p>From the results it clear that eight observations, 0.8 of our dataset observations, were split into the training set.</p>
<p><strong>Test Set</strong>:</p>
<p><img src="data-preprocessing_files/test_set.png" alt="test_set" class="moz-reader-block-img"></p>
<p>From the output it clear that two observations went to the test set.</p>
<h3 id="step-5-feature-scaling">Step 5: Feature scaling</h3>
<p>It’s a common case that in most datasets, features also known as 
inputs, are not on the same scale. Many machine learning models are 
Euclidian distant-based.</p>
<p>It happens that, the features with the large units dominate those 
with small units when it comes to calculation of the Euclidian distance 
and it will be as if those features with small units do not exist.</p>
<p>To ensure this does not occur, we need to encode our features so that
 they all fall in the range between -3 and 3. There are several ways we 
can use to scale our features. The most used one is the standardization 
and normalization technique.</p>
<p>The normalization technique is used when the data is normally 
distributed while standardization works with both normally distributed 
and the data that is not normally distributed.</p>
<p>The formula for these two techniques is shown below.</p>
<p><img src="data-preprocessing_files/one.png" alt="scaling formula" class="moz-reader-block-img"></p>
<p>Now, let’s scale both the training set and test set of our dataset separately.</p>
<p>Here is how we achieve this:</p>
<div><pre tabindex="0"><code data-lang="r"><span><span>training_set[, <span>2</span><span>:</span><span>3</span>] <span>=</span> <span>scale</span>(training_set[, <span>2</span><span>:</span><span>3</span>])
</span></span><span><span>test_set[, <span>2</span><span>:</span><span>3</span>] <span>=</span> <span>scale</span>(test_set[, <span>2</span><span>:</span><span>3</span>])
</span></span><span><span>training_set
</span></span><span><span>test_set
</span></span></code></pre></div><p>Executing our code we obtain:</p>
<p><strong>Training Set</strong>:</p>
<p><img src="data-preprocessing_files/scaled_training_set.png" alt="scale(training_set)" class="moz-reader-block-img"></p>
<p><strong>Test Set</strong>:</p>
<p><img src="data-preprocessing_files/scaled_test_set.png.png" alt="scale(test_set)" class="moz-reader-block-img"></p>
<p>Our training and test set were successfully scaled.</p>
<blockquote>
<p>Note that in our code we specified the columns to be scale.</p>
</blockquote>
<p>If we fail to do so, R will show us an error.</p>
<p>Such as:</p>
<div><pre tabindex="0"><code data-lang="r"><span><span>training_set <span>=</span> <span>scale</span>(training_set)<span># returns an error</span>
</span></span></code></pre></div><p>The reason is that our encoded columns are not treated as numeric entries.</p>
<h3 id="conclusion">Conclusion</h3>
<p>This is the end of our data preprocessing journey. Our data is now well prepared to give <a href="https://www.section.io/engineering-education/topic/machine-learning/">Machine Learning</a> models that can predict future outcomes effectively. I hope you enjoyed every step to this end.</p>
<p>Happy coding.</p>
<hr>
<p>Peer Review Contributions by: <a href="https://www.section.io/engineering-education/authors/mohan-raj/">Mohan Raj</a></p></div></div></div>
    </div>

    <div>
      <div class="reader-message"></div>
    </div>
    <div aria-owns="toolbar"></div>
  </div>

  <div id="pocket-cta-container" hidden="">
    <div class="pocket-cta-inner" id="pocket-cta-only">
      <div class="pocket-cta">
        <header class="pocket-cta-header">Save anything from across the web in Pocket, your personal library.</header>
        <p class="pocket-cta-subhead">As part of the Firefox family, 
Pocket provides a quiet, calm space that’s perfect for reading. It 
strips away all the distractions of the internet so you can really 
focus.</p>
        <a href="https://getpocket.com/signup?utm_source=firefox_reader&amp;utm_medium=variant_cta_only" class="pocket-btn pocket-sign-up"><strong>Sign up</strong> - it’s free</a>
        <a href="https://getpocket.com/explore?utm_source=firefox_reader&amp;utm_medium=variant_cta_only" class="pocket-btn pocket-discover-more"><strong>Discover more</strong></a>
      </div>
      <button class="pocket-dismiss-cta" title="Dismiss"></button>
    </div>

    <div class="pocket-cta-inner" id="pocket-cta-and-recs">
      <div class="pocket-recs-top">
        <div class="col">
          <header class="pocket-cta-header">Discover the most thought-provoking stories out there, curated by Pocket.</header>
          <p class="pocket-cta-subhead">As part of the Firefox family, 
Pocket surfaces the best articles out there—new perspectives, intriguing
 deep-dives, timeless classics—and we do this with the same dedication 
to privacy you’ve come to expect from Firefox and Mozilla. </p>
        </div>
        <div class="col">
          <button class="pocket-collapse-recs"></button>
        </div>
      </div>

      <div class="pocket-recs"></div>

      <div class="pocket-sign-up-wrapper">
        <a href="https://getpocket.com/explore?utm_source=firefox_reader&amp;utm_medium=variant_cta_plus_recs" class="pocket-btn pocket-sign-up"><strong>Discover more</strong></a>
      </div>
    </div>
  </div>



</body></html>